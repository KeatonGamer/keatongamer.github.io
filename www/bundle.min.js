(()=>{var o=["js/libs/pixi.js","js/libs/pako.min.js","js/libs/localforage.min.js","js/libs/effekseer.min.js","js/libs/vorbisdecoder.js","js/rmmz_core.js","js/rmmz_managers.js","js/rmmz_objects.js","js/rmmz_scenes.js","js/rmmz_sprites.js","js/rmmz_windows.js","js/plugins.js"],t="js/libs/effekseer.wasm",s=class{constructor(){this.xhrSucceeded=!1,this.loadCount=0,this.error=null}run(){this.showLoadingSpinner(),this.testXhr(),this.hookNwjsClose(),this.loadMainScripts()}showLoadingSpinner(){let e=document.createElement("div"),r=document.createElement("div");e.id="loadingSpinner",r.id="loadingSpinnerImage",e.appendChild(r),document.body.appendChild(e)}eraseLoadingSpinner(){let e=document.getElementById("loadingSpinner");e&&document.body.removeChild(e)}testXhr(){let e=new XMLHttpRequest;e.open("GET",document.currentScript.src),e.onload=()=>this.xhrSucceeded=!0,e.send()}hookNwjsClose(){typeof nw=="object"&&nw.Window.get().on("close",()=>nw.App.quit())}loadMainScripts(){for(let e of o){let r=document.createElement("script");r.type="text/javascript",r.src=e,r.async=!1,r.defer=!0,r.onload=this.onScriptLoad.bind(this),r.onerror=this.onScriptError.bind(this),r._url=e,document.body.appendChild(r)}this.numScripts=o.length,window.addEventListener("load",this.onWindowLoad.bind(this)),window.addEventListener("error",this.onWindowError.bind(this))}onScriptLoad(){++this.loadCount===this.numScripts&&PluginManager.setup($plugins)}onScriptError(e){this.printError("Failed to load",e.target._url)}printError(e,r){if(this.eraseLoadingSpinner(),!document.getElementById("errorPrinter")){let n=document.createElement("div");n.id="errorPrinter",n.innerHTML=this.makeErrorHtml(e,r),document.body.appendChild(n)}}makeErrorHtml(e,r){let n=document.createElement("div"),i=document.createElement("div");return n.id="errorName",i.id="errorMessage",n.innerHTML=e,i.innerHTML=r,n.outerHTML+i.outerHTML}onWindowLoad(){if(this.xhrSucceeded)if(this.isPathRandomized()){let e="Please move the Game.app to a different folder.";this.printError("Error",e)}else this.error?this.printError(this.error.name,this.error.message):this.initEffekseerRuntime();else{let e="Your browser does not allow to read local files.";this.printError("Error",e)}}onWindowError(e){this.error||(this.error=e.error)}isPathRandomized(){return typeof process=="object"&&process.mainModule.filename.startsWith("/private/var")}initEffekseerRuntime(){let e=this.onEffekseerLoad.bind(this),r=this.onEffekseerError.bind(this);effekseer.initRuntime(t,e,r)}onEffekseerLoad(){this.eraseLoadingSpinner(),SceneManager.run(Scene_Boot)}onEffekseerError(){this.printError("Failed to load",t)}},d=new s;d.run();})();
